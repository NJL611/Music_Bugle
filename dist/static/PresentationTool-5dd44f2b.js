import{aS as cn,r as c,aT as ut,aU as ln,aV as un,aG as dn,j as a,aW as et,u as ee,aX as Lt,F as W,aY as pn,aZ as dt,a_ as fn,C as ie,q as K,t as ye,x as L,B as Y,a$ as hn,b0 as mn,b1 as vn,b2 as gn,b3 as pt,b4 as yn,b5 as ft,b6 as bn,b7 as ke,S as le,b8 as ht,b9 as wn,ba as xn,bb as jn,o as mt,L as Se,n as Ce,a3 as Ut,bc as Pn,Z as At,bd as Mt,be as En,bf as kn,bg as Ae,aa as Sn,bh as Cn,bi as $n,bj as In,l as Rn,I as _n,bk as Dt,bl as On,bm as zn,bn as Wt,bo as Tn,T as Ln,bp as Un,i as An,h as Be,bq as Ke,br as Ve,w as Mn,bs as Dn,bt as Wn,ac as Nt,ae as Ft,ag as Nn,bu as Bt,ao as Fn,aK as Kt,bv as Bn,af as Kn}from"./sanity-81459e8b.js";import{A as Vn,c as qn}from"./DisplayedDocumentBroadcaster-f4a22b37.js";function Gn({children:e,isValidProp:t,...n}){t&&cn(t),n={...c.useContext(ut),...n},n.isStatic=ln(()=>n.isStatic);const i=c.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return c.createElement(ut.Provider,{value:i},e)}const Jn=un,Xn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/_key\s*==\s*['"](.*)['"]/,Hn=/^\d*:\d*$/;function nt(e){return typeof e=="number"||typeof e=="string"&&/^\[\d+\]$/.test(e)}function Ie(e){return typeof e=="string"?tt.test(e.trim()):typeof e=="object"&&"_key"in e}function Vt(e){if(typeof e=="string"&&Hn.test(e))return!0;if(!Array.isArray(e)||e.length!==2)return!1;const[t,n]=e;return(typeof t=="number"||t==="")&&(typeof n=="number"||n==="")}function Zn(e,t,n){const i=typeof t=="string"?qt(t):t;if(!Array.isArray(i))throw new Error("Path must be an array or a string");let r=e;for(let o=0;o<i.length;o++){const l=i[o];if(nt(l)){if(!Array.isArray(r))return n;r=r[l]}if(Ie(l)){if(!Array.isArray(r))return n;r=r.find(m=>m._key===l._key)}if(typeof l=="string"&&(r=typeof r=="object"&&r!==null?r[l]:void 0),typeof r>"u")return n}return r}function Qn(e){if(!Array.isArray(e))throw new Error("Path is not an array");return e.reduce((t,n,i)=>{const r=typeof n;if(r==="number")return`${t}[${n}]`;if(r==="string")return`${t}${i===0?"":"."}${n}`;if(Ie(n)&&n._key)return`${t}[_key=="${n._key}"]`;if(Array.isArray(n)){const[o,l]=n;return`${t}[${o}:${l}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)},"")}function qt(e){if(typeof e!="string")throw new Error("Path is not a string");const t=e.match(Xn);if(!t)throw new Error("Invalid path string");return t.map(Yn)}function Yn(e){return nt(e)?er(e):Ie(e)?tr(e):Vt(e)?nr(e):e}function er(e){return Number(e.replace(/[^\d]/g,""))}function tr(e){return{_key:e.match(tt)[1]}}function nr(e){const[t,n]=e.split(":").map(i=>i===""?i:Number(i));return[t,n]}var Gt=Object.freeze({__proto__:null,fromString:qt,get:Zn,isIndexSegment:nt,isIndexTuple:Vt,isKeySegment:Ie,reKeySegment:tt,toString:Qn});const vt="drafts.";function $i(e){return e.startsWith(vt)?e.slice(vt.length):e}const gt={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},yt={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function rr(e){return`$${e.map(t=>typeof t=="string"?`['${t.replace(/[\f\n\r\t'\\]/g,n=>gt[n])}']`:typeof t=="number"?`[${t}]`:t._key!==""?`[?(@._key=='${t._key.replace(/['\\]/g,n=>gt[n])}')]`:`[${t._index}]`).join("")}`}function Ii(e){const t=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let i;for(;(i=n.exec(e))!==null;){if(i[1]!==void 0){const r=i[1].replace(/\\(\\|f|n|r|t|')/g,o=>yt[o]);t.push(r);continue}if(i[2]!==void 0){t.push(parseInt(i[2],10));continue}if(i[3]!==void 0){const r=i[3].replace(/\\(\\')/g,o=>yt[o]);t.push({_key:r,_index:-1});continue}}return t}function ir(e){return e.map(t=>{if(typeof t=="string"||typeof t=="number")return t;if(t._index!==-1)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)})}function Ri(e,t){if(!(t!=null&&t.mappings))return;const n=rr(ir(e));if(t.mappings[n]!==void 0)return{mapping:t.mappings[n],matchedPath:n,pathSuffix:""};const i=Object.entries(t.mappings).filter(([m])=>n.startsWith(m)).sort(([m],[d])=>d.length-m.length);if(i.length==0)return;const[r,o]=i[0],l=n.substring(r.length);return{mapping:o,matchedPath:r,pathSuffix:l}}function or(e){return e!==null&&Array.isArray(e)}function bt(e){return typeof e=="object"&&e!==null}function Me(e,t,n=[]){return or(e)?e.map((i,r)=>{if(bt(i)){const o=i._key;if(typeof o=="string")return Me(i,t,n.concat({_key:o,_index:r}))}return Me(i,t,n.concat(r))}):bt(e)?Object.fromEntries(Object.entries(e).map(([i,r])=>[i,Me(r,t,n.concat(i))])):t(e,n)}const Jt="sanity.previewUrlSecret",ar="sanity-preview-url-secret",sr="2023-11-09",Re="sanity-preview-secret",rt="sanity-preview-pathname",cr=3600,lr=`*[_type == "${Jt}" && dateTime(_updatedAt) <= dateTime(now()) - 3600]`,ur="sanity.preview-url-secret";function dr(e){const t=new URL(e);return t.searchParams.delete(rt),t.searchParams.delete(Re),t}function pr(e){return e.searchParams.has(Re)}function fr(e,t,n){const i=new URL(e);return i.searchParams.set(Re,t),i.searchParams.set(rt,n),i}async function Xt(e,t,n,i,r=dn()){const o=e.withConfig({apiVersion:sr});try{const l=new Date(Date.now()+1e3*cr),m=`${ar}.${r}`,d=function(){if(typeof crypto<"u"){const f=new Uint8Array(16);crypto.getRandomValues(f);let s="";for(let p=0;p<f.length;p++)s+=f[p].toString(16).padStart(2,"0");return s=btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),s}return Math.random().toString(36).slice(2)}(),h=o.patch(m).set({secret:d,source:t,studioUrl:n,userId:i});return await o.transaction().createOrReplace({_id:m,_type:Jt}).patch(h).commit({tag:ur}),{secret:d,expiresAt:l}}finally{await o.delete({query:lr})}}function hr(e){const{draftMode:t,previewMode:n,origin:i=typeof location>"u"?"https://localhost":location.origin}=e,r=(n==null?void 0:n.enable)||(t==null?void 0:t.enable);let{preview:o="/"}=e;const l=new URL(o,i),m=r?new URL(r,i):void 0;return async d=>{try{if(d.previewSearchParam){const f=new URL(d.previewSearchParam,l);f.origin===l.origin&&(o=`${f.pathname}${f.search}`)}else if(d.referrer){const f=new URL(d.referrer);f.origin===l.origin&&(o=`${f.pathname}${f.search}`)}}catch{}typeof location<"u"&&location.origin===l.origin&&d.studioBasePath&&(o.startsWith(`${d.studioBasePath}/`)||o===d.studioBasePath)&&(o=e.preview||"/");const h=new URL(o,l);if(m){const f=new URL(m),{searchParams:s}=f;return s.set(Re,d.previewUrlSecret),h.pathname!==f.pathname&&s.set(rt,`${h.pathname}${h.search}`),f.toString()}return h.toString()}}const mr=e=>typeof e=="object"&&typeof e.then=="function",xe=[];function vr(e,t,n=(i,r)=>i===r){if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function gr(e,t=null,n=!1,i={}){t===null&&(t=[e]);for(const o of xe)if(vr(t,o.keys,o.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return i.lifespan&&i.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,i.lifespan)),o.response;if(!n)throw o.promise}const r={keys:t,equal:i.equal,remove:()=>{const o=xe.indexOf(r);o!==-1&&xe.splice(o,1)},promise:(mr(e)?e:e(...t)).then(o=>{r.response=o,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(o=>r.error=o)};if(xe.push(r),!n)throw r.promise}const wt=(e,t,n)=>gr(e,t,!1,n);var yr=Object.defineProperty,br=(e,t,n)=>(((i,r,o)=>{r in i?yr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o})(e,typeof t!="symbol"?t+"":t,n),n);let je;const wr=new Uint8Array(16);function xr(){if(!je&&(je=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!je))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return je(wr)}const D=[];for(let e=0;e<256;++e)D.push((e+256).toString(16).slice(1));var xt={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Pe(e,t,n){if(xt.randomUUID&&!t&&!e)return xt.randomUUID();const i=(e=e||{}).random||(e.rng||xr)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let r=0;r<16;++r)t[n+r]=i[r];return t}return function(r,o=0){return D[r[o+0]]+D[r[o+1]]+D[r[o+2]]+D[r[o+3]]+"-"+D[r[o+4]]+D[r[o+5]]+"-"+D[r[o+6]]+D[r[o+7]]+"-"+D[r[o+8]]+D[r[o+9]]+"-"+D[r[o+10]]+D[r[o+11]]+D[r[o+12]]+D[r[o+13]]+D[r[o+14]]+D[r[o+15]]}(i)}const jr=1e3,Pr=1e3,Er=500,kr=["handshake/syn","handshake/syn-ack","handshake/ack"],jt=e=>kr.some(t=>t===e),Sr=({data:e={}})=>typeof e=="object"&&e!==null&&!Array.isArray(e)&&!("domain"in e)&&["id","type","from","to"].every(t=>t in e)&&e.type.startsWith("handshake/");function Pt(e){const t=e.target,n=e.connectTo.map(s=>({buffer:[],config:s,id:"",handler:r,status:"connecting",interval:void 0,heartbeat:void 0}));function i(s){window.clearInterval(s.interval)}function r(s){const{data:p}=s;if(jt(p.type)){const u=n.find(v=>v.config.id===p.from);u&&p.type==="handshake/syn-ack"&&(d(u,"connected"),h(u,"handshake/ack",{id:u.id}))}}const o=s=>{var p,u,v;const w=s.data;if(!jt(w.type)&&n.find(y=>y.id===w.connectionId)){const y=n.find(b=>b.config.id===w.from);if(y){const b=[w.type,w.data];(u=(p=y.config).onEvent)==null||u.call(p,...b),(v=e.onEvent)==null||v.call(e,...b),f(y,"channel/response",{responseTo:w.id},!1)}}};function l(s){var p;if(Sr(s))console.error(`Visual editing package mismatch detected! Please ensure you are using the latest version of Sanity Studio and any packages listed here:
https://github.com/sanity-io/visual-editing`);else if(function(u){const{data:v,origin:w}=u;return v.domain==="sanity/channels"&&v.to==e.id&&n.map(y=>y.config.id).includes(v.from)&&v.type!=="channel/response"&&w===e.targetOrigin}(s)){const{data:u}=s;(p=n.find(v=>v.config.id===u.from))==null||p.handler(s)}}function m(s){s.heartbeat&&window.clearInterval(s.heartbeat)}function d(s,p){var u,v,w;s.status=p,(v=(u=s.config).onStatusUpdate)==null||v.call(u,p,s.config.id),(w=e.onStatusUpdate)==null||w.call(e,p,s.config.id),p==="connecting"||p==="reconnecting"?(s.handler=r,m(s),function(y){y.id=Pe(),y.interval=window.setInterval(()=>{h(y,"handshake/syn",{id:y.id})},Er)}(s)):p==="connected"?(s.handler=o,i(s),function(y){if(m(y),y.config.heartbeat){const b=typeof y.config.heartbeat=="number"?y.config.heartbeat:Pr;y.heartbeat=window.setInterval(()=>{f(y,"channel/heartbeat")},b)}}(s),function(y){const b=[...y.buffer];y.buffer.splice(0,y.buffer.length),b.forEach(({type:P,data:g})=>{f(y,P,g)})}(s)):p==="disconnected"&&(s.id=null,s.handler=r,i(s),m(s))}function h(s,p,u){if(!s.id)throw new Error("No channel ID set");const v={connectionId:s.id,data:u,domain:"sanity/channels",from:e.id,id:Pe(),to:s.config.id,type:p};try{t==null||t.postMessage(v,{targetOrigin:"*"})}catch{throw new Error(`Failed to postMessage '${v.id}' on '${e.id}'`)}}function f(s,p,u,v=!0){const w=Pe();if(s.status==="connecting"||s.status==="reconnecting"||s.status==="disconnected")return void s.buffer.push({type:p,data:u});if(!s.id)throw new Error("No channel ID set");const y={connectionId:s.id,data:u,domain:"sanity/channels",from:e.id,id:w,to:s.config.id,type:p};if(v){const b=setTimeout(()=>{y.connectionId===s.id&&(window.removeEventListener("message",P,!1),p!=="channel/heartbeat"&&s.buffer.push({type:p,data:u}),d(s,"reconnecting"),console.warn(`Received no response to message '${y.type}' on client '${e.id}' (ID: '${y.id}').`))},jr),P=g=>{var $;const{data:x}=g;x.type==="channel/response"&&($=x.data)!=null&&$.responseTo&&x.data.responseTo===y.id&&(window.removeEventListener("message",P,!1),clearTimeout(b))};window.addEventListener("message",P,!1)}try{t==null||t.postMessage(y,{targetOrigin:e.targetOrigin})}catch{throw new Error(`Failed to postMessage '${y.id}' on client '${e.id}'`)}}return window.addEventListener("message",l,!1),n.forEach(s=>{d(s,"connecting")}),{destroy:function(){n.forEach(s=>{["disconnected"].includes(s.status)||(f(s,"channel/disconnect",{id:s.id},!1),d(s,"disconnected"))}),window.removeEventListener("message",l,!1),n.forEach(s=>{m(s),i(s)})},send:function(s,p,u){(s?Array.isArray(s)?[...s]:[s]:n).forEach(v=>{const w=n.find(y=>y.config.id===v);if(!w)throw new Error("Invalid channel ID");f(w,p,u)})}}}var Cr=class extends Error{constructor(e){super(e[0].message),br(this,"issues"),this.name="ValiError",this.issues=e}};function qe(e,t){return Array.isArray(e)?[void 0,e]:[e,t]}function Ht(e,t,n,i,r){var o,l,m,d,h;const f=(h=(d=(m=(l=(o=t.message)!=null?o:function(s,p){var u;return(u=void 0)==null?void 0:u.get(p)}(n,r.lang))!=null?l:e?(r.lang,void 0):null)!=null?m:i==null?void 0:i.message)!=null?d:function(s){}(r.lang))!=null?h:r.message;return typeof f=="function"?f(r):f}function _e(e,t,n){return{typed:e,output:t,issues:n}}function it(e){let t=typeof e;return t==="object"&&(t=e?Object.getPrototypeOf(e).constructor.name:"null"),t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t}function $r(e,t,n){var i;const r=(i=n.received)!=null?i:it(n.input),o={reason:e.type,context:n.context.type,expected:n.context.expects,received:r,message:`Invalid ${n.label}: ${n.context.expects?`Expected ${n.context.expects} but r`:"R"}eceived ${r}`,input:n.input,requirement:n.context.requirement,path:n.path,lang:t==null?void 0:t.lang,abortEarly:t==null?void 0:t.abortEarly,abortPipeEarly:t==null?void 0:t.abortPipeEarly,skipPipe:t==null?void 0:t.skipPipe};return o.message=Ht(!1,n.context,n.reference,t,o),o}function Zt(e,t,n,i){if(e.pipe&&(n==null||!n.skipPipe))for(const r of e.pipe){const o=r._parse(t);if(o.issues){for(const l of o.issues){const m=$r(e,n,l);i?i.push(m):i=[m]}if(n!=null&&n.abortEarly||n!=null&&n.abortPipeEarly)break}else t=o.output}return _e(!0,t,i)}function ot(e,t,n,i,r){var o,l;const m=it(n),d=(o=r==null?void 0:r.expected)!=null?o:e.expects,h={reason:(l=r==null?void 0:r.reason)!=null?l:"type",context:e.type,expected:d,received:m,message:`Invalid type: Expected ${d} but received ${m}`,input:n,path:r==null?void 0:r.path,issues:r==null?void 0:r.issues,lang:i==null?void 0:i.lang,abortEarly:i==null?void 0:i.abortEarly,abortPipeEarly:i==null?void 0:i.abortPipeEarly,skipPipe:i==null?void 0:i.skipPipe};return h.message=Ht(!0,e,t,i,h),{typed:!1,output:n,issues:[h]}}function Qt(e,t){return{...e,fallback:t,_parse(n,i){const r=e._parse(n,i);return r.issues?_e(!0,function(o,l){return typeof o.fallback=="function"?o.fallback(l):o.fallback}(this,{input:n,issues:r.issues})):r}}}function Ee(e,t,n,i){const[r,o,l]=function(d,h,f){if(!d||typeof d=="object"&&!Array.isArray(d)){const[u,v]=qe(h,f);return[d,u,v]}const[s,p]=qe(d,h);return[void 0,s,p]}(t,n,i);let m;return{type:"object",expects:"Object",async:!1,entries:e,rest:r,message:o,pipe:l,_parse(d,h){if(d&&typeof d=="object"){m=m??Object.entries(this.entries);let f,s=!0;const p={};for(const[u,v]of m){const w=d[u],y=v._parse(w,h);if(y.issues){const b={type:"object",origin:"value",input:d,key:u,value:w};for(const P of y.issues)P.path?P.path.unshift(b):P.path=[b],f==null||f.push(P);if(f||(f=y.issues),h!=null&&h.abortEarly){s=!1;break}}y.typed||(s=!1),(y.output!==void 0||u in d)&&(p[u]=y.output)}if(this.rest&&(h==null||!h.abortEarly||!f)){for(const u in d)if(!(u in this.entries)){const v=d[u],w=this.rest._parse(v,h);if(w.issues){const y={type:"object",origin:"value",input:d,key:u,value:v};for(const b of w.issues)b.path?b.path.unshift(y):b.path=[y],f==null||f.push(b);if(f||(f=w.issues),h!=null&&h.abortEarly){s=!1;break}}w.typed||(s=!1),p[u]=w.output}}return s?Zt(this,p,h,f):_e(!1,p,f)}return ot(this,Ee,d,h)}}}function Oe(e,t){return{type:"picklist",expects:e.map(it).join(" | "),async:!1,options:e,message:t,_parse(n,i){return this.options.includes(n)?_e(!0,n):ot(this,Oe,n,i)}}}function Ge(e,t,n){const i=e._parse(t,function(r){var o,l,m,d;return{lang:(o=r==null?void 0:r.lang)!=null?o:void 0,message:r==null?void 0:r.message,abortEarly:(l=r==null?void 0:r.abortEarly)!=null?l:void 0,abortPipeEarly:(m=r==null?void 0:r.abortPipeEarly)!=null?m:void 0,skipPipe:(d=r==null?void 0:r.skipPipe)!=null?d:void 0}}(n));if(i.issues)throw new Cr(i.issues);return i.output}const Ir=/^([A-Za-z]+):([0-9]+)$/,Rr=/^([A-Za-z]+):([0-9]+),([0-9]+)$/,_r=/^([A-Za-z]+):([a-z0-9]+)$/;function Or(e,t){return`${e}-${typeof t=="string"?t:JSON.stringify(t)}`}const Et={alt:"altKey",ctrl:"ctrlKey",mod:typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"};function kt(e){return e.key==="Alt"}function at(e){const{children:t,message:n,onRetry:i,onContinueAnyway:r,...o}=e,l=a.jsx(Y,{fontSize:1,mode:"ghost",onClick:i,text:"Retry"}),m=a.jsx(Y,{fontSize:1,mode:"ghost",tone:"critical",onClick:r,text:"Continue anyway"});return a.jsx(ie,{height:"fill",...o,children:a.jsx(W,{align:"center",height:"fill",justify:"center",children:a.jsx(Rn,{padding:4,sizing:"border",width:0,children:a.jsxs(le,{space:4,children:[a.jsxs(le,{space:3,children:[a.jsx(L,{size:1,weight:"semibold",children:"An error occured"}),a.jsx(L,{muted:!0,size:1,children:n})]}),t,i&&r?a.jsxs(_n,{space:2,children:[l,m]}):i?a.jsx(K,{children:l}):r?a.jsx(K,{children:m}):null]})})})})}function ze(){const e=c.useContext(Dt);if(!e)throw new Error("Presentation context is missing");return e}function zr(e){const t=["comment","inspect","instruction","pathKey","rev","since","template","view"];return function(n={}){const i=Object.entries(n).map(([r,o])=>`${r}=${o}`).join("&");return i.length?`?${i}`:""}(Object.entries(e).filter(([n])=>t.includes(n)).reduce((n,[i,r])=>r==null?n:{...n,[i]:r},{}))}const Tr=c.forwardRef(function(e,t){const{params:n,structureParams:i}=ze();return a.jsx(et,{...e,ref:t,state:{type:void 0,_searchParams:Object.entries({...i,preview:n.preview})},title:void 0})}),Lr=c.forwardRef(function(e,t){const{documentId:n,documentType:i,parentRefPath:r,template:o,...l}=e;return a.jsx(et,{...l,ref:t,state:{id:n,type:i,_searchParams:Object.entries({preview:e.previewUrl})},title:void 0})});function Yt(e){const{children:t,onStructureParams:n,params:i,previewUrl:r,refs:o}=e,{state:l,resolvePathFromState:m}=At(),d=Mt(Object.fromEntries(l._searchParams||[])),h=c.useCallback(s=>`${m(l)}${zr({...d,...s})}`,[m,d,l]),f=c.useMemo(()=>({index:0,groupIndex:0,siblingIndex:0,payload:{},params:i,hasGroupSiblings:!1,groupLength:1,routerPanesState:[],ChildLink:s=>{const{childId:p,...u}=s,v=o==null?void 0:o.find(w=>w._id===p||Bt(w._id)===p);return v?a.jsx(et,{...u,state:{id:p,type:v._type,_searchParams:Object.entries({preview:r})}}):a.jsx("div",{...u})},BackLink:Tr,ReferenceChildLink:s=>a.jsx(Lr,{...s,previewUrl:r}),ParameterizedLink:()=>a.jsx(a.Fragment,{children:"ParameterizedLink"}),closeCurrentAndAfter:()=>{console.warn("closeCurrentAndAfter")},handleEditReference:s=>{console.warn("handleEditReference",s)},replaceCurrent:s=>{console.warn("replaceCurrent",s)},closeCurrent:()=>{console.warn("closeCurrent")},duplicateCurrent:s=>{console.warn("duplicateCurrent",s)},setView:s=>{console.warn("setView",s)},setParams:s=>{var p;n({...s,inspect:(p=s.inspect)!=null?p:void 0})},setPayload:s=>{console.warn("setPayload",s)},navigateIntent:(s,p,u)=>{console.warn("navigateIntent",s,p,u)},createPathWithParams:h}),[h,n,i,r,o]);return a.jsx(Fn.Provider,{value:f,children:t})}const Ur=ee(Kt)`
  height: 100%;
`,Ar=ee(W)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,Mr=ee(Ce)`
  white-space: pre-wrap;
`;function Dr(e){const{onStructureParams:t,previewUrl:n,refs:i}=e,{devMode:r}=ze(),o=c.useMemo(()=>({id:"$root",options:{filter:"_id in $ids",params:{ids:i.map(f=>f._id)}},schemaTypeName:"",title:"Documents on this page",type:"documentList"}),[i]),[l,m]=c.useState(null),d=c.useCallback(()=>m(null),[]),[h]=c.useState(()=>({}));return c.useEffect(()=>m(null),[i]),l?a.jsx(at,{flex:1,message:"Could not render the document list",onRetry:d,children:r&&a.jsx(ie,{overflow:"auto",padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Error message"}),a.jsx(Mr,{size:1,children:l.error.message})]})})}):a.jsx(Nt,{onCatch:m,children:a.jsx(Ur,{children:a.jsx(Ft,{children:a.jsx(Yt,{onStructureParams:t,params:h,previewUrl:n,refs:i,children:a.jsx(Ar,{direction:"column",flex:1,children:a.jsx(Nn,{index:0,itemId:"$root",pane:o,paneKey:"$root"})})})})})})}const Wr=ee(Ce)`
  white-space: pre-wrap;
`;function Nr(e){const{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,params:o,previewUrl:l}=e,{template:m,templateParams:d}=o,{devMode:h}=ze(),f=c.useMemo(()=>({id:t,options:{id:t,type:n,template:m,templateParameters:Bn(d)},title:"",type:"document"}),[t,n,m,d]),[s,p]=c.useState(null),u=c.useCallback(()=>p(null),[]);return c.useEffect(()=>{p(null)},[t,n,o]),s?a.jsx(at,{flex:1,message:"Could not render the document editor",onRetry:u,children:h&&a.jsx(ie,{overflow:"auto",padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Error message"}),a.jsx(Wr,{size:1,children:s.error.message})]})})}):a.jsx(Nt,{onCatch:p,children:a.jsx(Kt,{style:{height:"100%"},children:a.jsx(Yt,{onStructureParams:r,params:o,previewUrl:l,children:a.jsx(Kn,{paneKey:"document",index:1,itemId:"document",pane:f,onFocusPath:i})})})})}function Fr(e){const{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,previewUrl:o,structureParams:l}=e;return a.jsx(Ft,{children:a.jsx(Nr,{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,params:l,previewUrl:o})})}function Br(e){const{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,previewUrl:o,refs:l,structureParams:m}=e;return t&&n?a.jsx(Fr,{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,previewUrl:o,structureParams:m}):a.jsx(Dr,{onStructureParams:r,previewUrl:o,refs:l})}const Te=c.createContext(null);Te.displayName="PanelsContext";const Kr=ee.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,Je=function({children:e,defaultSize:t=null,id:n,minWidth:i,maxWidth:r,order:o=0}){const l=c.useContext(Te);if(l===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:m,registerElement:d,unregisterElement:h}=l,f=m(n);return c.useLayoutEffect(()=>(d(n,{id:n,type:"panel",defaultSize:t,maxWidth:r??null,minWidth:i??0,order:o}),()=>{h(n)}),[n,t,o,r,i,d,h]),a.jsx(Kr,{style:f,children:e})},Vr=ee.div`
  position: relative;
`,qr=ee.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:e})=>e?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:e})=>!e&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,en=function({id:e,order:t,disabled:n=!1}){const i=c.useRef(null),r=c.useContext(Te);if(r===null)throw Error("Panel components must be rendered within a PanelGroup container");const o=function(y){return c.useRef(y||Pe()).current}(e),{activeResizer:l,drag:m,startDragging:d,stopDragging:h,registerElement:f,unregisterElement:s}=r,p=l===o;if(r===null)throw Error("Panel components must be rendered within a PanelGroup container");const u=c.useCallback(y=>{d(o,y.nativeEvent)},[o,d]),v=c.useCallback(y=>{m(o,y)},[o,m]),w=c.useCallback(()=>{i.current.blur(),h()},[h]);return c.useEffect(()=>{if(p&&!n)return window.addEventListener("mousemove",v),window.addEventListener("mouseup",w),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",w)}},[n,p,v,w]),c.useLayoutEffect(()=>(f(o,{id:o,order:t,type:"resizer",el:i}),()=>{s(o)}),[o,t,f,s]),a.jsx(Vr,{onMouseDown:u,ref:i,children:a.jsxs(qr,{$disabled:n,children:[a.jsx("span",{}),a.jsx("span",{})]})})};function tn(e,t){let n;return(...i)=>{clearTimeout(n),n=setTimeout(()=>{e.apply(e,i)},t)}}const nn="presentation/panels",St=()=>JSON.parse(localStorage.getItem(nn)||"{}"),Ct=e=>e.map(t=>[t.id,t.order].join(":")).join(",");function Gr(){return c.useMemo(()=>{const e=(t,n)=>{const i=St(),r=Ct(t);(o=>{localStorage.setItem(nn,JSON.stringify(o))})({...i,[r]:n})};return{get:t=>St()[Ct(t)],set:e,setDebounced:tn(e,100)}},[])}function Xe(e,t,n){const{maxWidth:i,minWidth:r}=e,o=i==null?100:i/n*100,l=r/n*100;return Math.min(o,Math.max(l,t))}function Jr(e,t,n){if(e.length===1)return"100";const i=n[e.findIndex(r=>r.id===t)];return i==null?"0":i.toPrecision(10)}function $t(e,t,n=0,i=null){return e.clientX-(i||t.getBoundingClientRect()).left-n}function De(e){return e.type==="panel"}function It(e){return e.type==="resizer"}function Rt(e){return Array.from(e.values()).sort(({order:t},{order:n})=>t==null&&n==null?0:t==null?-1:n==null?1:t-n)}function _t(e,t,n){const i=t.reduce((l,m)=>l+m,0),r=[...t].map(l=>l/i*100);let o=0;for(let l=0;l<e.length;l++){const m=e[l],d=r[l],h=Xe(m,d,n);d!=h&&(o+=d-h,r[l]=h)}if(o.toFixed(3)!=="0.000")for(let l=0;l<e.length;l++){const m=e[l];let{maxWidth:d,minWidth:h}=m;h=h/n*100,d!=null&&(d=d/n*100);const f=Math.min(d??100,Math.max(h,r[l]+o));if(f!==r[l]&&(o-=f-r[l],r[l]=f,Math.abs(o).toFixed(3)==="0.000"))break}return r}const Xr=ee.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,Hr=function({children:e}){const t=c.useRef(null),[n,i]=c.useState(new Map),r=c.useMemo(()=>Rt(n).filter(De),[n]),[o,l]=c.useState([]),[m,d]=c.useState(null),h=c.useRef({elements:n,panels:r,widths:o}),f=c.useCallback(g=>({flexGrow:Jr(r,g,o),pointerEvents:m===null?void 0:"none"}),[m,r,o]),s=c.useCallback((g,$)=>{i(x=>{if(x.has(g))return x;const E=new Map(x);return E.set(g,$),E})},[]),p=c.useCallback(g=>{i($=>{if(!$.has(g))return $;const x=new Map($);return x.delete(g),x})},[]),u=c.useRef({containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]}),v=c.useCallback((g,$)=>{const x=Rt(n),E=x.findIndex(I=>I.id===g),R=n.get(g);if(!R||!It(R))return;const O=R.el.current;O&&(u.current={resizerIndex:E,panelBefore:x.reduce((I,z,_)=>De(z)&&_<E?z:I,null),panelAfter:x.reduce((I,z,_)=>I===null&&De(z)&&_>E?z:I,null),containerWidth:window.innerWidth,startX:$.pageX,dragOffset:$t($,O),resizerRect:O.getBoundingClientRect(),widths:h.current.widths},d(g))},[n]),w=c.useCallback(()=>{d(null)},[]),y=c.useCallback((g,$)=>{$.preventDefault(),$.stopPropagation();const{containerWidth:x,dragOffset:E,panelBefore:R,panelAfter:O,resizerRect:I}=u.current;if(R==null||O==null)return;const z=n.get(g);if(!z||!It(z))return;const _=z.el.current;if(!_)return;const pe=$t($,_,E,I);if(pe===0)return;const{widths:te}=h.current,fe=function(U,ne,A,oe,ae,he){const{panels:J,widths:re}=ae,{widths:N}=he,F=N||re,ue=[...F];{const H=U<0?oe:A,V=F[J.findIndex(Le=>Le.id===H.id)],Z=Xe(H,V+Math.abs(U),ne);if(V===Z)return F;U=U<0?V-Z:Z-V}let de=0,me=U<0?A:oe,X=J.findIndex(H=>H.id===me.id);for(;;){const H=J[X],V=F[X],Z=Xe(H,V-(Math.abs(U)-Math.abs(de)),ne);if(V!==Z&&(de+=V-Z,ue[X]=Z,de.toPrecision(10).localeCompare(Math.abs(U).toPrecision(10),void 0,{numeric:!0})>=0))break;if(U<0){if(--X<0)break}else if(++X>=J.length)break}return de===0?F:(me=U<0?oe:A,X=J.findIndex(H=>H.id===me.id),ue[X]=F[X]+de,ue)}(pe/t.current.getBoundingClientRect().width*100,x,R,O,h.current,u.current);te.some((U,ne)=>U!==fe[ne])&&l(fe)},[n]);c.useLayoutEffect(()=>{h.current.elements=n,h.current.panels=r,h.current.widths=o},[n,r,o]);const b=Gr();c.useLayoutEffect(()=>{const{widths:g}=h.current;if(g.length===r.length)return;const $=b.get(r);if($){const E=_t(r,$,window.innerWidth);return void l(E)}const x=function(E){let R=E.length,O=100;const I=E.map(_=>_.defaultSize?(O-=_.defaultSize,R-=1,_.defaultSize):null),z=O/R;return I.map(_=>_===null?z:_)}(r);l(x)},[b,r]),c.useEffect(()=>{o.length&&b.setDebounced(r,o)},[b,r,o]),c.useLayoutEffect(()=>{const g=new ResizeObserver(()=>{const{panels:$,widths:x}=h.current,E=_t($,x,window.innerWidth);x.some((R,O)=>R!==E[O])&&l(E)});return g.observe(t.current),()=>{g.disconnect()}},[]);const P=c.useMemo(()=>({activeResizer:m,drag:y,getPanelStyle:f,registerElement:s,startDragging:v,stopDragging:w,unregisterElement:p}),[m,y,f,s,v,w,p]);return a.jsx(Te.Provider,{value:P,children:a.jsx(Xr,{ref:t,children:e})})},Zr=function(e){const{children:t,navigate:n}=e,i=c.useCallback((r,o=void 0)=>{n(o||{},r?{preview:r}:{})},[n]);return a.jsx(On.Provider,{value:i,children:t})};function Qr(e){const{unstable_navigator:t}=e,n=!(t==null||!t.component),[i,r]=function(d,h){const[f,s]=c.useState(()=>{var p;return JSON.parse((p=localStorage.getItem(d))!=null?p:JSON.stringify(h))});return c.useEffect(()=>{localStorage.setItem(d,JSON.stringify(f))},[d,f]),[f,s]}("presentation/navigator",n),o=!!n&&i,l=c.useMemo(()=>{if(n)return()=>r(d=>!d)},[n,r]),m=c.useCallback(function(){return a.jsx(a.Fragment,{children:o&&a.jsx(Yr,{...t})})},[o,t]);return[{navigatorEnabled:o,toggleNavigator:l},m]}const Yr=c.memo(function(e){const{minWidth:t,maxWidth:n,component:i}=e,r=t!=null&&n!=null&&t===n;return a.jsxs(a.Fragment,{children:[a.jsx(Je,{id:"navigator",minWidth:t,maxWidth:n,order:1,children:a.jsx(i,{})}),a.jsx(en,{order:2,disabled:r})]})}),ei=function(e){const{children:t,params:n}=e,i=c.useMemo(()=>n,[n]);return a.jsx(zn.Provider,{value:i,children:t})},ti=function(e){const{children:t,devMode:n,name:i,navigate:r,params:o,structureParams:l}=e,m=c.useMemo(()=>({devMode:n,name:i,navigate:r,params:o,structureParams:l}),[n,i,r,o,l]);return a.jsx(Dt.Provider,{value:m,children:t})},st="ACTION_IFRAME_LOADED",He="ACTION_IFRAME_REFRESH",Ze="ACTION_IFRAME_RELOAD",Qe="ACTION_PERSPECTIVE",Ye="ACTION_VIEWPORT",rn="ACTION_VISUAL_EDITING_OVERLAYS_TOGGLE",ni=(e,t)=>{switch(t.type){case st:return e.iframe.status==="loaded"?e:{...e,iframe:{...e.iframe,status:"loaded"}};case He:return e.iframe.status==="refreshing"?e:{...e,iframe:{...e.iframe,status:"refreshing"}};case Ze:return e.iframe.status==="reloading"?e:{...e,iframe:{...e.iframe,status:"reloading"}};case Qe:return{...e,perspective:Ge(on,t.perspective)};case Ye:return{...e,viewport:Ge(an,t.viewport)};case rn:return ri(e,t);default:return e}},ri=(e,t)=>e.visualEditing.overlaysEnabled===t.enabled?e:{...e,visualEditing:{...e.visualEditing,overlaysEnabled:t.enabled}},ii=Oe(["loading","loaded","refreshing","reloading"]),on=Qt(Oe(["published","previewDrafts"]),"previewDrafts"),an=Qt(Oe(["desktop","mobile"]),"desktop"),oi=Ee({iframe:Ee({status:ii}),perspective:on,viewport:an,visualEditing:Ee({overlaysEnabled:function e(t,n){const[i,r]=qe(t,n);return{type:"boolean",expects:"boolean",async:!1,message:i,pipe:r,_parse(o,l){return typeof o=="boolean"?Zt(this,o,l):ot(this,e,o,l)}}}()})}),ai={iframe:{status:"loading"},perspective:"previewDrafts",viewport:"desktop",visualEditing:{overlaysEnabled:!1}};function si(e){return Ge(oi,{...ai,...e})}const ci=Lt(ee.iframe`
  border: 0;
  max-height: 100%;
  width: 100%;
  display: block;
`),li=function(e){var t;const{basePath:n="/"}=((t=Wt())==null?void 0:t.activeWorkspace)||{},{fontSize:i=1,onChange:r,origin:o,padding:l=3,prefix:m,suffix:d,value:h}=e,f=c.useRef(null),[s,p]=c.useState(void 0),[u,v]=c.useState(void 0),w=c.useCallback(g=>{p(g.currentTarget.value)},[]),y=c.useCallback(g=>{var $;if(g.key==="Enter"){if(s===void 0)return;const x=s.startsWith("/")||s===""?`${o}${s}`:s;if(!x.startsWith(o+"/")&&x!==o)return void v(`URL must start with ${o}`);if(!o&&(x.startsWith(`${n}/`)||x===n))return void v(`URL can't have the same base path as the Studio ${n}`);const E=x===o?o+"/":x;v(void 0),p(void 0),r(E.slice(o.length)),($=f.current)==null||$.blur()}g.key==="Escape"&&(v(void 0),p(void 0))},[n,r,o,s]),b=c.useCallback(()=>{v(void 0),p(void 0)},[]);c.useEffect(()=>{v(void 0),p(void 0)},[o,h]);const P=c.useMemo(()=>({icon:Tn}),[]);return a.jsx(a.Fragment,{children:a.jsx(Ln,{clearButton:u?P:void 0,customValidity:u,fontSize:i,onBlur:b,onClear:()=>{v(void 0),p(o+h)},onChange:w,onKeyDownCapture:y,padding:l,prefix:m,style:{zIndex:1},radius:2,ref:f,space:l,suffix:d,value:s===void 0?`${o}${h}`:s})})};function ui(e){const{initialUrl:t,openPopup:n,previewLocationOrigin:i,previewLocationRoute:r}=e,o=c.useCallback(l=>{l.preventDefault(),n(l.currentTarget.href)},[n]);return a.jsxs(a.Fragment,{children:[a.jsx(di,{initialUrl:t,previewLocationOrigin:i,previewLocationRoute:r}),a.jsx(ke,{icon:Un,text:"Open preview",as:"a",href:`${i}${r}`,onClick:o,rel:"opener",target:"_blank"})]})}function di(e){const{initialUrl:t,previewLocationOrigin:n,previewLocationRoute:i}=e,{push:r}=An(),o=Be({apiVersion:Ke}),l=Ve(),[m,d]=c.useState(!1);return a.jsx(ke,{disabled:m,onClick:()=>{if(navigator==null||!navigator.clipboard)return r({closable:!0,status:"error",title:"Clipboard not supported"}),!1;d(!0);let h,f=`${n}${i}`;const s=()=>{r({id:h,closable:!0,status:"success",title:"The URL is copied to the clipboard"}),d(!1)},p=u=>{r({closable:!0,status:"error",title:"Copy failed",description:u.message||u.toString()}),d(!1)};if(pr(t)&&typeof ClipboardItem<"u"){const u="text/plain",v=async()=>{h=r({closable:!0,title:"Copying URL to clipboard…"});const y=await Xt(o,"@sanity/presentation",typeof window>"u"?"":location.href,l==null?void 0:l.id);return f=fr(t,y.secret,i).toString(),new Blob([f],{type:u})},w=new ClipboardItem({[u]:v()});navigator.clipboard.write([w]).then(s).catch(p)}else navigator.clipboard.writeText(f).then(s).catch(p)},text:"Copy link",icon:Mn})}const We=Lt(W),Ne={previewDrafts:"Drafts",published:"Published"},pi="caution",fi="positive",Ot={previewDrafts:Dn,published:Wn},hi=c.forwardRef(function(e,t){const{dispatch:n,iframe:i,initialUrl:r,loadersConnection:o,navigatorEnabled:l,onPathChange:m,onRefresh:d,openPopup:h,overlaysConnection:f,params:s,perspective:p,targetOrigin:u,toggleNavigator:v,toggleOverlay:w,viewport:y,visualEditing:{overlaysEnabled:b}}=e,{devMode:P}=ze(),g=pn(),$=c.useCallback(()=>n({type:Ye,viewport:"desktop"}),[n]),x=c.useCallback(()=>n({type:Ye,viewport:"mobile"}),[n]),E=i.status==="loading"||i.status==="reloading",[R,O]=c.useState(!1),I=i.status==="refreshing",[z,_]=c.useState(!1),pe=E||I||f==="connecting",te=c.useMemo(()=>u===location.origin?"":u,[u]),fe=c.useCallback(()=>{d(()=>{typeof t=="function"||t==null||!t.current||(n({type:Ze}),t.current.src=`${u}${s.preview||"/"}`)})},[n,d,s.preview,u,t]),U=c.useCallback(()=>{typeof t=="function"||t==null||!t.current||(t.current.src=r.toString(),n({type:Ze}))},[n,t,r]),ne=c.useCallback(()=>{oe(!0)},[]),[A,oe]=c.useState(!1),[ae,he]=c.useState(!1);c.useEffect(()=>{if(!(E||I||f!=="connecting"&&f!=="reconnecting")){const N=setTimeout(()=>{he(!0)},1e3);return()=>clearTimeout(N)}},[f,E,I]),c.useEffect(()=>{if(!E&&!I&&ae){if(f==="connected"&&(_(!1),he(!1),O(!1),oe(!1)),f==="connecting"){const N=setTimeout(()=>{O(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},dt);return()=>clearTimeout(N)}if(f==="reconnecting"){const N=setTimeout(()=>{O(!0),_(!0)},dt);return()=>clearTimeout(N)}f==="disconnected"&&_(!0)}},[E,f,I,ae]);const J=c.useMemo(()=>{const N=new URL(s.preview||"/",u),{pathname:F,search:ue}=dr(N);return`${F}${ue}`},[s.preview,u]),re=c.useCallback(()=>{n({type:st})},[n]);return c.useEffect(()=>{if(typeof t=="function"||t==null||!t.current)return;const N=t.current;function F(){N===document.activeElement&&N.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))}return window.addEventListener("blur",F),()=>{window.removeEventListener("blur",F)}},[t]),a.jsx(Gn,{transition:g?{duration:0}:void 0,children:a.jsxs(fn,{delay:1e3,children:[a.jsx(ie,{flex:"none",padding:2,shadow:1,style:{position:"relative"},children:a.jsxs(W,{align:"center",style:{minHeight:0},children:[v&&a.jsx(K,{flex:"none",marginRight:1,padding:1,children:a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:"Toggle navigator"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Toggle navigator",fontSize:1,icon:hn,mode:"bleed",onClick:v,padding:2,selected:l})})}),a.jsx(ye,{animate:!0,content:a.jsxs(W,{align:"center",style:{whiteSpace:"nowrap"},children:[a.jsx(K,{padding:1,children:a.jsx(L,{size:1,children:b?"Disable edit overlay":"Enable edit overlay"})}),a.jsx(K,{paddingY:1,children:a.jsx(mn,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})})]}),fallbackPlacements:["bottom-start"],padding:1,placement:"bottom",portal:!0,children:a.jsx(ie,{as:"label",flex:"none",marginRight:1,padding:3,style:{lineHeight:0,borderRadius:999,userSelect:"none"},tone:b?"transparent":void 0,children:a.jsxs(W,{align:"center",gap:3,children:[a.jsx("div",{style:{margin:-4},children:a.jsx(vn,{checked:b,onChange:w,disabled:i.status==="loading"||f!=="connected"})}),a.jsx(K,{children:a.jsx(L,{muted:!b,size:1,weight:"medium",children:"Edit"})})]})})}),a.jsx(K,{flex:1,marginX:1,children:a.jsx(li,{prefix:a.jsx(K,{padding:1,children:a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:i.status==="loading"?"Loading…":i.status==="reloading"||i.status==="refreshing"?"Refreshing…":"Refresh preview"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Refresh preview",fontSize:1,icon:gn,mode:"bleed",loading:i.status==="reloading"||i.status==="refreshing",onClick:fe,padding:2})})}),onChange:m,origin:te,suffix:a.jsx(K,{padding:1,children:a.jsx(pt,{button:a.jsx(Y,{fontSize:1,iconRight:yn,mode:"bleed",padding:2,space:2}),id:"location-menu",menu:a.jsx(ft,{children:a.jsx(ui,{initialUrl:r,openPopup:h,previewLocationOrigin:te,previewLocationRoute:J})}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})}),value:J})}),a.jsx(W,{align:"center",flex:"none",gap:1,padding:1,children:a.jsx(pt,{button:a.jsx(Y,{fontSize:1,iconRight:bn,mode:"bleed",padding:2,space:2,text:Ne[o==="connected"?p:"previewDrafts"],loading:o==="reconnecting"&&i.status!=="loaded",disabled:o!=="connected"}),id:"perspective-menu",menu:a.jsxs(ft,{style:{maxWidth:240},children:[a.jsx(ke,{fontSize:1,onClick:()=>n({type:Qe,perspective:"previewDrafts"}),padding:3,pressed:p==="previewDrafts",tone:pi,children:a.jsxs(W,{align:"flex-start",gap:3,children:[a.jsx(K,{flex:"none",children:a.jsx(L,{size:1,children:c.createElement(Ot.previewDrafts)})}),a.jsxs(le,{flex:1,space:2,children:[a.jsx(L,{size:1,weight:"medium",children:Ne.previewDrafts}),a.jsx(L,{muted:!0,size:1,children:"View this page with latest draft content"})]}),a.jsx(K,{flex:"none",children:a.jsx(L,{muted:!0,size:1,style:{opacity:p==="previewDrafts"?1:0},children:a.jsx(ht,{})})})]})}),a.jsx(ke,{fontSize:1,onClick:()=>n({type:Qe,perspective:"published"}),padding:3,pressed:p==="published",tone:fi,children:a.jsxs(W,{align:"flex-start",gap:3,children:[a.jsx(K,{flex:"none",children:a.jsx(L,{size:1,children:c.createElement(Ot.published)})}),a.jsxs(le,{flex:1,space:2,children:[a.jsx(L,{size:1,weight:"medium",children:Ne.published}),a.jsx(L,{muted:!0,size:1,children:"View this page with published content"})]}),a.jsx(K,{flex:"none",children:a.jsx(L,{muted:!0,size:1,style:{opacity:p==="published"?1:0},children:a.jsx(ht,{})})})]})})]}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})}),a.jsxs(W,{align:"center",flex:"none",gap:1,padding:1,children:[a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:"Full viewport"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Full viewport",fontSize:1,icon:wn,mode:"bleed",onClick:$,padding:2,selected:y==="desktop"})}),a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:"Narrow viewport"}),padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Narrow viewport",fontSize:1,icon:xn,mode:"bleed",onClick:x,padding:2,selected:y==="mobile"})})]})]})}),a.jsx(ie,{flex:1,tone:"transparent",children:a.jsxs(W,{align:"center",height:"fill",justify:"center",padding:y==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:pe?"wait":void 0},children:[a.jsx(jn,{children:z||E||I||!ae||A?(E||f==="connecting"&&i.status!=="refreshing")&&!A?a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:zt,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:a.jsxs(W,{style:{...$e[y]},justify:"center",align:"center",direction:"column",gap:4,children:[a.jsx(mt,{muted:!0}),a.jsx(L,{muted:!0,size:1,children:"Loading…"})]})}):z&&!A?a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:mi,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute",borderTop:"1px solid transparent",boxShadow:"0 0 0 1px var(--card-border-color)"},children:a.jsx(at,{flex:1,message:"Could not connect to the preview",onRetry:U,onContinueAnyway:ne,children:P&&a.jsxs(a.Fragment,{children:[f!=="connected"&&a.jsx(ie,{padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Overlay connection status"}),a.jsx(Ce,{size:1,children:f})]})}),o!=="connected"&&a.jsx(ie,{padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Loader connection status"}),a.jsx(Ce,{size:1,children:o})]})})]})})}):null:a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:zt,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:R?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:R?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:a.jsxs(W,{style:{...$e[y]},justify:"center",align:"center",direction:"column",gap:4,children:[R&&a.jsx(Y,{disabled:!0,fontSize:1,mode:"ghost",text:"Continue anyway",style:{opacity:0}}),a.jsx(ie,{radius:2,tone:R?"caution":"inherit",padding:4,shadow:1,children:a.jsxs(W,{justify:"center",align:"center",direction:"column",gap:4,children:[a.jsx(mt,{muted:!0}),a.jsx(L,{muted:!0,size:1,children:R?a.jsx(a.Fragment,{children:"Unable to connect, check the browser console for more information."}):"Connecting…"})]})}),R&&a.jsx(Y,{fontSize:1,tone:"critical",onClick:ne,text:"Continue anyway"})]})})}),a.jsx(ci,{ref:t,style:{pointerEvents:(E||f==="connecting"&&i.status!=="refreshing")&&!A?"none":"auto",boxShadow:"0 0 0 1px var(--card-border-color)",borderTop:"1px solid transparent"},src:r.toString(),initial:["background"],variants:vi,animate:[(E||f==="connecting"&&i.status!=="refreshing")&&!A?"background":"active",E?"reloading":"idle",y,ae&&!A?"timedOut":""],onLoad:re})]})})]})})}),$e={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},zt={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},mi={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},vi={desktop:{...$e.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...$e.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};let Tt=!1;function gi(e){var t;if(e===void 0)return;const n=(t=decodeURIComponent(e))==null?void 0:t.split(".");return n[0]==="drafts"&&n.shift(),n.join(".")}function yi(e){if(e!==void 0)return Gt.toString(function(t){const n=[];for(const i of t.split(".")){const r=Ir.exec(i);if(r){n.push(r[1],Number(r[2]));continue}const o=Rr.exec(i);if(o){n.push(o[1],[Number(o[2]),Number(o[3])]);continue}const l=_r.exec(i);l?n.push(l[1],{_key:l[2]}):n.push(i)}return n}(decodeURIComponent(e)))}function Fe(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0&&t!==""&&t!==null))}function bi({initialPreviewUrl:e,routerNavigate:t,routerState:n,routerSearchParams:i,frameStateRef:r}){const o=c.useMemo(()=>{const{id:d,path:h,type:f}={id:gi((s=n).id),path:yi(s.path),type:s.type};var s;return{id:d,type:f,path:h,preview:i.preview||`${e.pathname}${e.search}`,perspective:i.perspective,viewport:i.viewport,inspect:i.inspect,rev:i.rev,since:i.since,template:i.template,templateParams:i.templateParams,view:i.view,pathKey:i.pathKey,instruction:i.instruction,comment:i.comment}},[n,i,e]),l=c.useMemo(()=>Fe({inspect:o.inspect,path:o.path,rev:o.rev,since:o.since,template:o.template,templateParams:o.templateParams,view:o.view,pathKey:o.pathKey,instruction:o.instruction,comment:o.comment}),[o.comment,o.inspect,o.instruction,o.path,o.pathKey,o.rev,o.since,o.template,o.templateParams,o.view]),m=c.useRef(n);return c.useEffect(()=>{m.current=n},[n]),{structureParams:l,navigate:c.useMemo(()=>tn((d,h={},f)=>{d.id&&(d.id=Bt(d.id));const{_searchParams:s,...p}=m.current,u=(s||[]).reduce((b,[P,g])=>(b[P]=g,b),{}),v=Fe({...p,...d}),w=Fe({...u,...h});p.id!==v.id&&(delete w.template,delete w.templateParams),v._searchParams=Object.entries(w).reduce((b,[P,g])=>[...b,[P,g]],[]);const y=f??w.preview===r.current.url;t(v,{replace:y})},50),[t,r]),params:o}}function wi(e,t,n){var i,r;const o=Be({apiVersion:Ke}),l=Wt(),m=((i=l==null?void 0:l.activeWorkspace)==null?void 0:i.basePath)||"/",d=((r=l==null?void 0:l.activeWorkspace)==null?void 0:r.name)||"default",h=function(s,p,u){const v=Ve();return c.useMemo(()=>["@sanity/presentation",p,u,s,v==null?void 0:v.id,xi],[p,v==null?void 0:v.id,s,u])}(t,m,d),f=function(s,p){const u=Be({apiVersion:Ke}),v=Ve(),[w,y]=c.useState(""),b=s?wt(async()=>await Xt(u,"@sanity/presentation",typeof window>"u"?"":location.href,v==null?void 0:v.id),[...p,w]):null;return c.useEffect(()=>{if(!b)return;const P=setTimeout(()=>{c.startTransition(()=>y(b.expiresAt.toString()))},b.expiresAt.getTime()-Date.now());return()=>clearTimeout(P)},[b]),(b==null?void 0:b.secret)||null}(typeof e=="object"||typeof e=="function",h);return wt(async()=>{if(typeof e=="string"){const p=new URL(e,location.origin);let u=p;try{if(n){const v=new URL(n,p);v.origin===p.origin&&(u=v)}else if(document.referrer){const v=new URL(document.referrer);v.origin===p.origin&&(u=v)}}catch{}return location.origin!==u.origin||!u.pathname.startsWith(`${m}/`)&&u.pathname!==m?u:p}const s=await(typeof e=="object"?hr(e):e)({client:o,previewUrlSecret:f,previewSearchParam:n,referrer:typeof document>"u"?null:document.referrer,studioBasePath:m});return new URL(s,location.origin)},[...h,f])}const xi=Symbol(),ji=c.lazy(()=>Ut(()=>import("./LoaderQueries-f7d045dc.js"),["static/LoaderQueries-f7d045dc.js","static/sanity-81459e8b.js","static/DisplayedDocumentBroadcaster-f4a22b37.js"])),Pi=c.lazy(()=>Ut(()=>import("./PostMessageRefreshMutations-e6922b3e.js"),["static/PostMessageRefreshMutations-e6922b3e.js","static/sanity-81459e8b.js"])),Ei=ee(W)`
  overflow-x: auto;
`;function ki(e){var t;const{previewUrl:n,components:i}=(t=e.tool.options)!=null?t:{},r=e.tool.name||Pn,{unstable_navigator:o}=i||{},{navigate:l,state:m}=At(),d=Mt(Object.fromEntries(m._searchParams||[])),h=wi(n||"/",r,d.preview||null),[f]=c.useState(()=>{var k;const S=(k=e.tool.options)==null?void 0:k.devMode;return typeof S=="function"?S():typeof S=="boolean"?S:typeof window<"u"&&window.location.hostname==="localhost"}),s=c.useMemo(()=>h.origin,[h.origin]),p=c.useRef(null),[u,v]=c.useState(),[w,y]=c.useState({}),b=c.useRef({title:void 0,url:void 0}),{navigate:P,params:g,structureParams:$}=bi({initialPreviewUrl:h,routerNavigate:l,routerState:m,routerSearchParams:d,frameStateRef:b}),[x,E]=c.useReducer(ni,{perspective:g.perspective,viewport:g.viewport},si),[R,O]=function(k,S){if(k!=="published"&&k!=="previewDrafts")throw new Error(`Invalid perspective: ${k}`);const[T,C]=c.useState({}),[j,q]=c.useState({}),B=c.useRef(""),ve=c.useCallback((se,M,ce=[])=>{const G=ce.filter(Q=>"_projectId"in Q&&Q._projectId?(Tt||(console.warn("Cross dataset references are not supported yet, ignoring source document",Q),Tt=!0),!1):Q);(M==="published"?C:q)(Q=>{const ge={};for(const we of G)ge[we._id]=we;if(B.current!==S.current.url)return B.current=S.current.url,{[se]:ge};const be=Q[se];return Vn(be,ge)?Q:{...Q,[se]:ge}})},[S]);return[c.useMemo(()=>{const se=Object.values(k==="published"?T:j).reduce((M,ce)=>(Object.values(ce).forEach(G=>{M[G._id]=G}),M),{});return Object.values(se)},[k,j,T]),ve]}(x.perspective,b),I=En(),z=kn();c.useEffect(()=>{(x.perspective!==g.perspective||x.viewport!==g.viewport)&&P({},{perspective:x.perspective==="previewDrafts"?void 0:x.perspective,viewport:x.viewport==="desktop"?void 0:x.viewport})},[g.perspective,x.perspective,P,x.viewport,g.viewport]);const[_,pe]=c.useState("connecting"),[te,fe]=c.useState("connecting"),[U,ne]=c.useState("connecting"),[A]=c.useState(()=>new Set),oe=c.useCallback(k=>{const S=window.open(k,"_blank");S&&A.add(S)},[A]);c.useEffect(()=>{if(A.size&&u)for(const k of A)k&&"closed"in k&&!k.closed&&u.addSource(k)},[u,A,A.size]),c.useEffect(()=>{var k;const S=(k=p.current)==null?void 0:k.contentWindow;if(!S)return;const T=function(C){const{destroy:j,send:q}=Pt(C),B=new Set,ve=new WeakMap,se=new Set;return{destroy:()=>{j();for(const M of se)M()},send:(M,...ce)=>{q(M,...ce);for(const G of B)G&&"closed"in G&&!G.closed&&ve.has(G)&&ve.get(G)(M,...ce)},addSource(M){if(B.has(M))return;if(!("closed"in M))throw console.warn("Source is unsupported",{source:M}),new Error("Source is unsupported");if(M.closed)throw new Error("Source is closed");const{send:ce,destroy:G}=Pt({...C,target:M,connectTo:C.connectTo.map(Q=>{const{onStatusUpdate:ge,onEvent:be,...we}=Q;return{...we,onEvent:be?(...lt)=>{const[Ue]=lt;if(Ue!=="preview-kit/documents"&&Ue!=="overlay/navigate"&&Ue!=="loader/documents")return be(...lt)}:void 0}})});se.add(G),ve.set(M,ce),B.add(M)}}}({id:"presentation",target:S,targetOrigin:s,connectTo:[{id:"overlays",heartbeat:!0,onStatusUpdate:pe,onEvent(C,j){if(C!=="visual-editing/focus"&&C!=="overlay/focus"||!("id"in j))if(C==="visual-editing/navigate"||C==="overlay/navigate"){const{title:q,url:B}=j;b.current.url!==B&&P({},{preview:B}),b.current={title:q,url:B}}else C==="visual-editing/meta"?b.current.title=j.title:C==="visual-editing/toggle"||C==="overlay/toggle"?E({type:rn,enabled:j.enabled}):C==="visual-editing/documents"?O("visual-editing",j.perspective,j.documents):C==="visual-editing/refreshing"&&j.source==="manual"?clearTimeout(Z.current):C==="visual-editing/refreshing"&&j.source==="mutation"?E({type:He}):C==="visual-editing/refreshed"&&E({type:st});else P({type:j.type,id:j.id,path:j.path})}},{id:"loaders",heartbeat:!0,onStatusUpdate:fe,onEvent(C,j){if(C==="loader/documents"&&j.projectId===I&&j.dataset===z)O("loaders",j.perspective,j.documents);else if(C==="loader/query-listen"&&j.projectId===I&&j.dataset===z){if(typeof j.heartbeat=="number"&&j.heartbeat<Ae)throw new Error(`Loader query listen heartbeat interval must be at least ${Ae}ms`);y(q=>{var B;return{...q,[Or(j.query,j.params)]:{perspective:j.perspective,query:j.query,params:j.params,receivedAt:Date.now(),heartbeat:(B=j.heartbeat)!=null&&B}}})}}},{id:"preview-kit",heartbeat:!0,onStatusUpdate:ne,onEvent(C,j){C==="preview-kit/documents"&&j.projectId===I&&j.dataset===z&&O("preview-kit",j.perspective,j.documents)}}]});return v(T),()=>{T.destroy(),v(void 0)}},[z,I,O,P,s]),c.useEffect(()=>{const k=setInterval(()=>c.startTransition(()=>y(S=>{if(Object.keys(S).length<1)return S;const T=Date.now();if(!Object.values(S).some(j=>j.heartbeat!==!1&&T>j.receivedAt+j.heartbeat))return S;const C={};for(const[j,q]of Object.entries(S))q.heartbeat!==!1&&T>q.receivedAt+q.heartbeat||(C[j]=q);return C})),Ae);return()=>clearInterval(k)},[]);const ae=c.useCallback(k=>{P({path:Gt.toString(k)},{},!0)},[P]),he=c.useCallback(k=>{const S=new URL(k,h.origin),T=S.pathname+S.search;S.origin===h.origin&&T!==g.preview&&P({},{preview:T})},[h,g,P]),J=c.useCallback(k=>{P({},k)},[P]);c.useEffect(()=>{u==null||u.send("overlays","presentation/perspective",{perspective:x.perspective})},[u,x.perspective]),c.useEffect(()=>{g.id&&g.path?u==null||u.send("overlays","presentation/focus",{id:g.id,path:g.path}):u==null||u.send("overlays","presentation/blur",void 0)},[u,g.id,g.path]),c.useEffect(()=>{b.current.url&&g.preview&&b.current.url!==g.preview&&(b.current.url=g.preview,_!=="connected"&&p.current?p.current.src=`${s}${g.preview}`:u==null||u.send("overlays","presentation/navigate",{url:g.preview,type:"replace"}))},[u,_,s,g.preview]);const re=c.useCallback(()=>u==null?void 0:u.send("overlays","presentation/toggleOverlay",void 0),[u]),[N,F]=c.useState(null);c.useEffect(()=>{const k=T=>{kt(T)&&re()},S=T=>{var C;kt(T)&&re(),C=T,["mod","\\"].every(j=>Et[j]?C[Et[j]]:C.key===j.toUpperCase())&&re()};return window.addEventListener("keydown",S),window.addEventListener("keyup",k),()=>{window.removeEventListener("keydown",S),window.removeEventListener("keyup",k)}},[re]);const[ue,de]=c.useState(null),[{navigatorEnabled:me,toggleNavigator:X},H]=Qr({unstable_navigator:o}),V=c.useRef(g.id);c.useEffect(()=>{g.rev&&V.current&&g.id!==V.current&&P({},{rev:void 0}),V.current=g.id});const Z=c.useRef(),Le=c.useCallback(k=>{if(E({type:He}),u)return Z.current=window.setTimeout(k,300),void u.send("overlays","presentation/refresh",{source:"manual",livePreviewEnabled:U==="connected"||te==="connected"});k()},[u,te,U]),ct=Sn(),sn=c.useCallback(({id:k,type:S,path:T})=>{if(b.current.url)return{title:b.current.title||b.current.url,name:"edit",params:{id:k,path:T,type:S,inspect:Cn,workspace:ct.name,mode:$n,preview:g.preview}}},[g.preview,ct.name]);return a.jsxs(a.Fragment,{children:[a.jsx(ti,{devMode:f,name:r,navigate:P,params:g,structureParams:$,children:a.jsx(Zr,{navigate:P,children:a.jsx(ei,{params:g,children:a.jsx(Ei,{height:"fill",children:a.jsxs(Hr,{children:[a.jsx(H,{}),a.jsx(Je,{id:"preview",minWidth:325,defaultSize:me?50:75,order:3,children:a.jsx(W,{direction:"column",flex:1,height:"fill",ref:de,children:a.jsx(In,{element:ue,children:a.jsx(hi,{dispatch:E,iframe:x.iframe,initialUrl:h,loadersConnection:te,navigatorEnabled:me,onPathChange:he,onRefresh:Le,openPopup:oe,overlaysConnection:_,params:g,perspective:x.perspective,ref:p,targetOrigin:s,toggleNavigator:X,toggleOverlay:re,viewport:x.viewport,visualEditing:x.visualEditing})})})}),a.jsx(en,{order:4}),a.jsx(Je,{id:"content",minWidth:325,order:5,children:a.jsx(qn,{documentId:g.id,setDisplayedDocument:F,children:a.jsx(Jn,{getIntent:sn,children:a.jsx(Br,{documentId:g.id,documentType:g.type,onFocusPath:ae,onStructureParams:J,previewUrl:g.preview,refs:R,structureParams:$})})})})]})})})})}),u&&a.jsx(c.Suspense,{children:a.jsx(ji,{channel:u,liveQueries:w,perspective:x.perspective,liveDocument:N,documentsOnPage:R})}),u&&g.id&&g.type&&a.jsx(c.Suspense,{children:a.jsx(Pi,{channel:u,id:g.id,type:g.type,loadersConnection:te,previewKitConnection:U})})]})}const _i=Object.freeze(Object.defineProperty({__proto__:null,default:ki},Symbol.toStringTag,{value:"Module"}));export{vt as D,_i as P,Zn as a,$i as g,Ii as p,Ri as r,Qn as t,Me as w};
